<script type="text/javascript">
    RED.nodes.registerType("OpenAI Response", {
        category: 'AI Intent',
        color: 'rgba(255, 0, 119, .5)',
        icon: "font-awesome/fa-commenting-o",
        defaults: {
            name: { value: "" },
            keepFormatting: { value: false },
            clearConversation: { value: false }
        },
        inputs: 1,
        outputs: 1,
        paletteLabel: "Response (Deprecated)",
        label: function () {
            return this.name ? `${this.name} (Deprecated)` : "Response (Deprecated)";
        },

        oneditprepare: function (x) {

        }
    });

</script>

<script type="text/html" data-template-name="OpenAI Response">

    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>

    <div style="display: flex; justify-content: space-around;">
    
        <label for="node-input-keepFormatting" style="display: flex;">
            <i class="fa fa-tag"></i>
            <span style="margin-left: 5px;">Keep Formatting</span>
            <input style="display: inline-block;margin-left: 1rem;" type="checkbox" id="node-input-keepFormatting"
                name="keep formatting">
        </label>

        <label for="node-input-clearConversation" style="display: flex;">
            <i class="fa fa-tag"></i>
            <span style="margin-left: 5px;">Clear Conversation</span>
            <input style="display: inline-block;margin-left: 1rem;" type="checkbox" id="node-input-clearConversation"
                name="removes the conversation from context">
        </label>
    </div>
</script>

<script type="text/html" data-help-name="OpenAI Response">
    <p>Sanitize the response from OpenAI and returns a consistent data interface </p>

    <h3>Details</h3>
    <p>This node must be used directly after the <code>OpenAI Chat</code> node.</p>

    <h4>Keep Formatting</h4>
    By default this node will strip the response from GPT to return a clean string. 
    This is to prevent anomolies caused by how different outputs (for example outputting to
     telegram vs text-to-speech). However, if you would like to keep the formatting GPT returns,
     mark the checkbox.

    <h4>Clear Conversation</h4>
    If the previous Chat node in the flow has a conversation id, then this node will clean up after 
    it and delete the any saved conversation under the given <pre>conversation_id</pre>. This option can be 
    dynamically triggered by setting **msg.clearConversation** to <pre>`true`</pre>
</script>